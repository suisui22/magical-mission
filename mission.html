<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ミッションに挑戦</title>
<style>
/* 軽いスタイル: 編集しやすくしています */
body{margin:0;font-family:"Noto Serif JP", "Cinzel Decorative", serif;background:linear-gradient(180deg,#050514,#000);color:#f7f3ff;padding-bottom:90px}
.container{max-width:920px;margin:0 auto;padding:18px}
.card{background:rgba(255,255,255,0.04);border-radius:12px;padding:16px;backdrop-filter: blur(6px);border:1px solid rgba(255,255,255,0.04)}
input{padding:12px;border-radius:10px;border:none;background:rgba(255,255,255,0.06);color:#fff;min-height:44px}
.btn{padding:12px;border-radius:10px;border:none;background:linear-gradient(90deg,#6f5bd8,#9e7cff);color:#fff;font-weight:700;min-height:44px}
.msg-wrong{color:#ffd6d6;margin-top:10px;display:none}
.hint{position:fixed;right:12px;bottom:12px;background:linear-gradient(180deg,#fde7ff,#e6d7ff);color:#2b0057;padding:10px 12px;border-radius:999px;font-weight:700;z-index:5;text-decoration:none}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <h2 id="missionTitle">ミッションに挑戦</h2>
    <div id="missionPoint" style="font-weight:800;margin-bottom:8px"></div>
    <input id="passInput" placeholder="合言葉を入力">
    <div id="wrongMsg" class="msg-wrong">何かが違うようです。</div>
    <div style="margin-top:12px;display:flex;gap:8px">
      <button id="checkBtn" class="btn">判定する</button>
      <button id="backBtn" class="btn" style="background:linear-gradient(90deg,#444,#666)">メインへ戻る</button>
    </div>
    <div id="solvedNote" style="margin-top:10px;color:#c9ffd7;display:none">このミッションは既に正解済みです。</div>
  </div>
</div>

<a class="hint" href="hint.html" target="_blank" rel="noopener noreferrer">🔮 ヒント</a>

<script>
/* データはindex.htmlと同じ配列構成を想定しています（同名配列） */
const MISSIONS = [
  { id:0, text:"光の魔法を唱えよ", answer:"ルミナス", point:10 },
  { id:1, text:"風を操る言葉を思い出せ", answer:"ゼフィール", point:8 },
  { id:2, text:"水の精霊に呼びかけよ", answer:"アクアリス", point:7 },
  { id:3, text:"炎を灯す呪文を言え", answer:"イグナイト", point:9 },
  { id:4, text:"時間を止める言葉", answer:"クロノス", point:12 },
  { id:5, text:"運命の輪を回せ", answer:"フォーチュナ", point:11 },
  { id:6, text:"闇を払う祈りを唱えよ", answer:"ノクス", point:10 },
  { id:7, text:"真実の扉を開ける鍵", answer:"ヴェリタス", point:13 },
  { id:8, text:"夢の守護者の名を答えよ", answer:"ソムニア", point:8 },
  { id:9, text:"星々の歌を知る者", answer:"ステラ", point:9 },
  { id:10, text:"心の声を形にせよ", answer:"アニマ", point:10 },
  { id:11, text:"最後の試練を越えよ", answer:"アルカナ", point:15 }
];

const TOTAL_KEY = "total_score";
const SOLVED_PREFIX = "mission_";
function getParam(name){ return new URL(location.href).searchParams.get(name) }
function getTotal(){ const t = parseInt(localStorage.getItem(TOTAL_KEY)); return Number.isNaN(t)?0:t }

const id = Number(getParam("id"));
const mission = (Number.isNaN(id) || !MISSIONS[id]) ? null : MISSIONS[id];

const titleEl = document.getElementById("missionTitle");
const pointEl = document.getElementById("missionPoint");
const input = document.getElementById("passInput");
const wrongMsg = document.getElementById("wrongMsg");
const checkBtn = document.getElementById("checkBtn");
const backBtn = document.getElementById("backBtn");
const solvedNote = document.getElementById("solvedNote");

if(!mission){
  titleEl.textContent = "無効なミッション";
  pointEl.style.display = "none";
  checkBtn.disabled = true;
} else {
  titleEl.textContent = `ミッション ${mission.id+1}： ${mission.text}`;
  pointEl.textContent = `${mission.point} 点`;
  if(localStorage.getItem(SOLVED_PREFIX + mission.id + "_solved")==="true") solvedNote.style.display="block";
}

checkBtn.addEventListener("click", ()=>{
  wrongMsg.style.display = "none";
  if(!mission) return;
  const v = input.value.trim();
  if(v === mission.answer){
    // go to correct page to add score
    location.href = `correct.html?id=${mission.id}`;
  } else {
    wrongMsg.style.display = "block";
  }
});

backBtn.addEventListener("click", ()=> location.href = "index.html");
</script>
</body>
</html>